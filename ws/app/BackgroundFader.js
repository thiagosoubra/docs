WS.BackgroundFader=Core.extend(Echo.Component,{$load:function(){Echo.ComponentFactory.registerType("WS.BackgroundFader",this);},pane:true,componentType:"WS.BackgroundFader"});WS.BackgroundFader.Sync=Core.extend(Echo.Render.ComponentSync,{$static:{Runnable:Core.extend(Core.Web.Scheduler.Runnable,{startTime:null,repeat:true,$construct:function(a){this._bgDiv=a;},run:function(){if(!this.startTime){this.startTime=new Date().getTime();}var a=(new Date().getTime()-this.startTime)/2000;if(a<1){this.timeInterval=100;this._bgDiv.style.opacity=Math.floor(100*a*a)/100;}else{this.repeat=false;this._bgDiv.style.opacity=1;this._bgDiv=null;}},timeInterval:100})},$load:function(){Echo.Render.registerPeer("WS.BackgroundFader",this);},_runnable:null,_bgDiv:null,$construct:function(){this._canFade=!Core.Web.Env.ENGINE_MSHTML;},renderAdd:function(f,b){this._div=document.createElement("div");this._bgDiv=document.createElement("div");this._bgDiv.id=this.component.renderId;this._bgDiv.style.cssText="position:absolute;width:100%;height:100%;";
Echo.Sync.Color.renderFB(this.component,this._bgDiv);Echo.Sync.Font.render(this.component.render("font"),this._bgDiv);Echo.Sync.FillImage.render(this.component.render("image"),this._bgDiv);this._div.appendChild(this._bgDiv);if(this.component.children.length>0){var e=this.component.children[0];var a=document.createElement("div");Echo.Render.renderComponentAdd(f,e,a);this._div.appendChild(a);}var d=this.component.render("image");if(this._canFade&&d){this._bgDiv.style.opacity=0;this._runnable=new WS.BackgroundFader.Sync.Runnable(this._bgDiv);Core.Web.Scheduler.add(this._runnable);var c=document.createElement("img");c.src=Echo.Sync.FillImage.getUrl(d);}b.appendChild(this._div);},renderDispose:function(a){if(this._runnable){Core.Web.Scheduler.remove(this._runnable);}this._bgDiv=null;this._div=null;},renderUpdate:function(c){var a=this._div;var b=a.parentNode;Echo.Render.renderComponentDispose(c,c.parent);b.removeChild(a);this.renderAdd(c,b);return true;}});
WS.CacheViewerModel=Core.extend(Extras.Viewer.Model,{_cache:null,_count:null,$construct:function(){Extras.Viewer.Model.call(this);this._cache={};},$abstract:{fetchImpl:function(b,a){}},$virtual:{emptyFetch:20,overFetch:10},cacheStore:function(e,d,a,c){for(var b=0;b<a.length;++b){this._cache[e+b]=a[b];}if(this._count===c){this.update(e,d);}else{this._count=c;this.refresh();}},fetch:function(e,d){e=Math.max(e-this.overFetch,0);d=Math.min(d+this.overFetch,this.size());if(d===0){this.fetchImpl(0,this.emptyFetch);}else{var c=null,b=null;for(var a=e;a<d;++a){if(!this._cache[a]){if(c===null){c=a;}b=a;}}if(c!==null){this.fetchImpl(c,b+1);}}},get:function(a){return this._cache[a];},size:function(){return this._count||0;}});
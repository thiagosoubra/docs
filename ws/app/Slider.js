WS.Slider=Core.extend(Echo.Component,{$load:function(){Echo.ComponentFactory.registerType("WS.Slider",this);},pane:true,componentType:"WS.Slider",doAction:function(a){this.fireEvent({source:this,type:"action",value:a});}});WS.Slider.Sync=Core.extend(Echo.Render.ComponentSync,{$load:function(){Echo.Render.registerPeer("WS.Slider",this);},_bounds:{width:0},_interactive:true,$construct:function(){this._setValueRunnable=new Core.Web.Scheduler.MethodRunnable(Core.method(this,this._setValue),100,true);},_createOverlay:function(){if(this._overlayDiv){return;}this._overlayDiv=document.createElement("div");this._overlayDiv.style.cssText="position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;z-index:31000";document.body.appendChild(this._overlayDiv);this.client.forceRedraw();},_processMouseDown:function(a){Core.Web.DOM.preventEventDefault(a);this._createOverlay();Core.Web.Event.add(this._overlayDiv,"mousemove",Core.method(this,this._processMouseMove),false);Core.Web.Event.add(this._overlayDiv,"mouseup",Core.method(this,this._processMouseUp),false);
Core.Web.Scheduler.add(this._setValueRunnable);},_processMouseMove:function(a){this._storeValue(a);},_processMouseUp:function(a){this._storeValue(a);this._removeOverlay();Core.Web.Scheduler.remove(this._setValueRunnable);this._setValue();},_removeOverlay:function(){if(!this._overlayDiv){return;}Core.Web.Event.removeAll(this._overlayDiv);document.body.removeChild(this._overlayDiv);this._overlayDiv=null;this.client.forceRedraw();},renderAdd:function(b,a){this._interactive=this.component.render("interactive",true);this._value=this.component.get("value")||0;this._minimumInset=Echo.Sync.Extent.toPixels(this.component.render("minimumInset",0));this._maximumInset=Echo.Sync.Extent.toPixels(this.component.render("maximumInset",0));this._div=document.createElement("div");this._div.style.cssText="cursor:pointer;overflow:hidden;position:relative;";this._div.id=this.component.renderId;Echo.Sync.Extent.render(this.component.render("height",10),this._div,"height",false,false);Echo.Sync.Color.renderFB(this.component,this._div);
Echo.Sync.Border.render(this.component.render("border"),this._div);this._valueDiv=document.createElement("div");this._valueDiv.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;";Echo.Sync.Color.render(this.component.render("valueColor"),this._valueDiv,"background");Echo.Sync.Border.render(this.component.render("valueBorder"),this._valueDiv);this._div.appendChild(this._valueDiv);a.appendChild(this._div);Core.Web.Event.add(this._div,"mousedown",Core.method(this,this._processMouseDown),false);},renderDisplay:function(){Core.Web.VirtualPosition.redraw(this._valueDiv);this._bounds=new Core.Web.Measure.Bounds(this._div);this._usableWidth=this._bounds.width-this._minimumInset-this._maximumInset;this._renderValue();},renderDispose:function(a){this._removeOverlay();Core.Web.Event.removeAll(this._div);this._div=null;this._valueDiv=null;},renderUpdate:function(c){if(c.isUpdatedPropertySetIn({value:true,valueColor:true})){return true;}else{var a=this._div;var b=a.parentNode;Echo.Render.renderComponentDispose(c,c.parent);
b.removeChild(a);this.renderAdd(c,b);return true;}},_renderValue:function(){Echo.Sync.Color.render(this.component.render("valueColor"),this._valueDiv,"background");var a=Math.min(100,Math.max(0,parseFloat(this.component.get("value")||0)));if(a===0){this._valueDiv.style.right=(this._usableWidth+this._maximumInset)+"px";}else{if(a===100){this._valueDiv.style.right=0;}else{this._valueDiv.style.right=((100-a)*this._usableWidth/100+this._maximumInset)+"px";}}Core.Web.VirtualPosition.redraw(this._valueDiv);},_setValue:function(){this.component.doAction(this._value);},_storeValue:function(b){var a=b.clientX-(this._bounds.left+this._minimumInset);this._value=Math.min(100,Math.max(0,100*a/this._usableWidth));}});
Echo.Sync.Button=Core.extend(Echo.Render.ComponentSync,{$static:{_defaultIconTextMargin:5,_prototypeButton:null,_createPrototypeButton:function(){var a=document.createElement("div");a.tabIndex="0";a.style.outlineStyle="none";a.style.cursor="pointer";return a;}},$load:function(){this._prototypeButton=this._createPrototypeButton();Echo.Render.registerPeer("Button",this);},enabled:null,div:null,_textElement:null,iconImg:null,_processRolloverExitRef:null,_processInitEventRef:null,_focused:false,$construct:function(){this._processInitEventRef=Core.method(this,this._processInitEvent);},$virtual:{doAction:function(){this.component.doAction();},renderContent:function(){var e=this.component.render("text");var d=Echo.Sync.getEffectProperty(this.component,"icon","disabledIcon",!this.enabled);if(e!=null){if(d){var a=this.component.render("iconTextMargin",Echo.Sync.Button._defaultIconTextMargin);var c=Echo.Sync.TriCellTable.getOrientation(this.component,"textPosition");var b=new Echo.Sync.TriCellTable(c,Echo.Sync.Extent.toPixels(a));
this.renderButtonText(b.tdElements[0],e);this.iconImg=this.renderButtonIcon(b.tdElements[1],d);this.div.appendChild(b.tableElement);}else{this.renderButtonText(this.div,e);}}else{if(d){this.iconImg=this.renderButtonIcon(this.div,d);}}},setHighlightState:function(j,f){var h=this.component&&this.component.application&&this.component.application.getFocusedComponent()==this.component;var k=f?"pressed":(j?"rollover":"focused");var b=h||f||j;var g=Echo.Sync.getEffectProperty(this.component,"foreground",k+"Foreground",b);var c=Echo.Sync.getEffectProperty(this.component,"background",k+"Background",b);var i=Echo.Sync.getEffectProperty(this.component,"backgroundImage",k+"BackgroundImage",b);var d=Echo.Sync.getEffectProperty(this.component,"font",k+"Font",b);var e=Echo.Sync.getEffectProperty(this.component,"border",k+"Border",b);Echo.Sync.Color.renderClear(g,this.div,"color");Echo.Sync.Color.renderClear(c,this.div,"backgroundColor");Echo.Sync.FillImage.renderClear(i,this.div,"backgroundColor");if(b){Echo.Sync.Insets.render(this.getInsetsForBorder(this.component.render(k+"Border")),this.div,"padding");
}else{Echo.Sync.Insets.render(this.component.render("insets"),this.div,"padding");}Echo.Sync.Border.renderClear(e,this.div);if(this._textElement){Echo.Sync.Font.renderClear(d,this._textElement);}if(this.iconImg){var a=Echo.Sync.ImageReference.getUrl(Echo.Sync.getEffectProperty(this.component,"icon",k+"Icon",b));if(a!=this.iconImg.src){this.iconImg.src=a;}}}},_addEventListeners:function(){this._processRolloverExitRef=Core.method(this,this._processRolloverExit);Core.Web.Event.remove(this.div,"focus",this._processInitEventRef);Core.Web.Event.remove(this.div,"mouseover",this._processInitEventRef);Core.Web.Event.add(this.div,"click",Core.method(this,this._processClick),false);if(this.component.render("rolloverEnabled")){Core.Web.Event.add(this.div,Core.Web.Env.PROPRIETARY_EVENT_MOUSE_ENTER_LEAVE_SUPPORTED?"mouseenter":"mouseover",Core.method(this,this._processRolloverEnter),false);Core.Web.Event.add(this.div,Core.Web.Env.PROPRIETARY_EVENT_MOUSE_ENTER_LEAVE_SUPPORTED?"mouseleave":"mouseout",Core.method(this,this._processRolloverExit),false);
}if(this.component.render("pressedEnabled")){Core.Web.Event.add(this.div,"mousedown",Core.method(this,this._processPress),false);Core.Web.Event.add(this.div,"mouseup",Core.method(this,this._processRelease),false);}Core.Web.Event.add(this.div,"focus",Core.method(this,this._processFocus),false);Core.Web.Event.add(this.div,"blur",Core.method(this,this._processBlur),false);Core.Web.Event.Selection.disable(this.div);},clientKeyDown:function(a){if(!this.client||!this.client.verifyInput(this.component)){return true;}if(a.keyCode==13){this.doAction();return false;}else{return true;}},getFocusFlags:function(){return Echo.Render.ComponentSync.FOCUS_PERMIT_ARROW_ALL;},getInsetsForBorder:function(c){var b=this.component.render("border");if(!c){return this.component.render("insets");}var d=Echo.Sync.Insets.toPixels(this.component.render("insets"));for(var a in d){d[a]+=Echo.Sync.Border.getPixelSize(b,a)-Echo.Sync.Border.getPixelSize(c,a);if(d[a]<0){d[a]=0;}}return d.top+" "+d.right+" "+d.bottom+" "+d.left;
},_processBlur:function(a){this.setHighlightState(false,false);},_processClick:function(a){if(!this.client||!this.client.verifyInput(this.component)){return true;}this.client.application.setFocusedComponent(this.component);this.doAction();},_processFocus:function(a){if(!this.client||!this.client.verifyInput(this.component)){return true;}this.client.application.setFocusedComponent(this.component);this.setHighlightState(false,false);},_processInitEvent:function(a){this._addEventListeners();switch(a.type){case"focus":this._processFocus(a);break;case"mouseover":if(this.component.render("rolloverEnabled")){this._processRolloverEnter(a);}break;}},_processPress:function(a){if(!this.client||!this.client.verifyInput(this.component)){return true;}Core.Web.DOM.preventEventDefault(a);this.setHighlightState(false,true);},_processRelease:function(a){if(!this.client){return true;}this.setHighlightState(false,false);},_processRolloverEnter:function(a){if(!this.client||!this.client.verifyInput(this.component)||Core.Web.dragInProgress){return true;
}this.client.application.addListener("focus",this._processRolloverExitRef);this.setHighlightState(true,false);return true;},_processRolloverExit:function(a){if(!this.client||!this.client.application){return true;}if(this._processRolloverExitRef){this.client.application.removeListener("focus",this._processRolloverExitRef);}this.setHighlightState(false,false);return true;},renderAdd:function(e,b){this.enabled=this.component.isRenderEnabled();this.div=Echo.Sync.Button._prototypeButton.cloneNode(false);this.div.id=this.component.renderId;Echo.Sync.LayoutDirection.render(this.component.getLayoutDirection(),this.div);if(this.enabled){Echo.Sync.Color.renderFB(this.component,this.div);Echo.Sync.Border.render(this.component.render("border"),this.div);Echo.Sync.FillImage.render(this.component.render("backgroundImage"),this.div);}else{Echo.Sync.Color.render(Echo.Sync.getEffectProperty(this.component,"foreground","disabledForeground",true),this.div,"color");Echo.Sync.Color.render(Echo.Sync.getEffectProperty(this.component,"background","disabledBackground",true),this.div,"backgroundColor");
Echo.Sync.Border.render(Echo.Sync.getEffectProperty(this.component,"border","disabledBorder",true),this.div);Echo.Sync.FillImage.render(Echo.Sync.getEffectProperty(this.component,"backgroundImage","disabledBackgroundImage",true),this.div);}Echo.Sync.Insets.render(this.component.render("insets"),this.div,"padding");Echo.Sync.Alignment.render(this.component.render("alignment"),this.div,true,this.component);var d=this.component.render("toolTipText");if(d){this.div.title=d;}var c=this.component.render("width");if(c){this.div.style.width=Echo.Sync.Extent.toCssValue(c,true,true);}var a=this.component.render("height");if(a){this.div.style.height=Echo.Sync.Extent.toCssValue(a,false);this.div.style.overflow="hidden";}this.renderContent();if(this.enabled){Core.Web.Event.add(this.div,"focus",this._processInitEventRef,false);Core.Web.Event.add(this.div,"mouseover",this._processInitEventRef,false);}b.appendChild(this.div);},renderButtonText:function(a,c){this._textElement=a;var b=this.component.render("textAlignment");
if(b){Echo.Sync.Alignment.render(b,a,true,this.component);}if(this.enabled){Echo.Sync.Font.render(this.component.render("font"),this._textElement);}else{Echo.Sync.Font.render(Echo.Sync.getEffectProperty(this.component,"font","disabledFont",true),this._textElement);}a.appendChild(document.createTextNode(c));if(!this.component.render("lineWrap",true)){a.style.whiteSpace="nowrap";}},renderButtonIcon:function(a,b){var d=this.component.render("alignment");if(d){Echo.Sync.Alignment.render(d,a,true,this.component);}var c=document.createElement("img");Echo.Sync.ImageReference.renderImg(b,c);a.appendChild(c);return c;},renderDispose:function(a){if(this._processRolloverExitRef){this.client.application.removeListener("focus",this._processRolloverExitRef);}Core.Web.Event.removeAll(this.div);this._focused=false;this.div=null;this._textElement=null;this.iconImg=null;},renderFocus:function(){if(this._focused){return;}Core.Web.DOM.focusElement(this.div);this._focused=true;},renderUpdate:function(c){var a=this.div;
var b=a.parentNode;this.renderDispose(c);b.removeChild(a);this.renderAdd(c,b);return false;}});
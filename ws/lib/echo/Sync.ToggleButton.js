Echo.Sync.ToggleButton=Core.extend(Echo.Sync.Button,{$load:function(){Echo.Render.registerPeer("ToggleButton",this);},$abstract:{inputType:null},_selected:false,_stateElement:null,doAction:function(){this.setSelected(!this._selected);Echo.Sync.Button.prototype.doAction.call(this);},getStateIcon:function(b,c){var a;if(this._selected){a=Echo.Sync.getEffectProperty(this.component,"selectedStateIcon","disabledSelectedStateIcon",!this.enabled);if(a){if(c){a=this.component.render("pressedSelectedStateIcon",a);}else{if(b){a=this.component.render("rolloverSelectedStateIcon",a);}}}}if(!a){a=Echo.Sync.getEffectProperty(this.component,"stateIcon","disabledStateIcon",!this.enabled);if(a){if(c){a=this.component.render("pressedStateIcon",a);}else{if(b){a=this.component.render("rolloverStateIcon",a);}}}}return a;},_processStateChange:function(a){this._updateStateElement();},renderAdd:function(b,a){this._selected=this.component.render("selected");Echo.Sync.Button.prototype.renderAdd.call(this,b,a);},renderContent:function(){var h=this.component.render("text");
var d=this.component.render("icon");var c,e,b;var a=(h!=null?1:0)+(d?1:0)+1;if(a==1){if(h!=null){this.renderButtonText(this.div,h);}else{if(d){this.iconImg=this.renderButtonIcon(this.div,d);}else{this._stateElement=this._renderButtonState(this.div);}}}else{if(a==2){c=Echo.Sync.TriCellTable.getInvertedOrientation(this.component,"statePosition","leading");e=this.component.render("stateMargin",Echo.Sync.Button._defaultIconTextMargin);b=new Echo.Sync.TriCellTable(c,Echo.Sync.Extent.toPixels(e));if(h!=null){this.renderButtonText(b.tdElements[0],h);if(d){this.iconImg=this.renderButtonIcon(b.tdElements[1],d);}else{this._stateElement=this._renderButtonState(b.tdElements[1]);}}else{this.iconImg=this.renderButtonIcon(b.tdElements[0],d);this._stateElement=this._renderButtonState(b.tdElements[1]);}this.div.appendChild(b.tableElement);}else{if(a==3){c=Echo.Sync.TriCellTable.getOrientation(this.component,"textPosition");e=this.component.render("iconTextMargin",Echo.Sync.Button._defaultIconTextMargin);
var f=Echo.Sync.TriCellTable.getInvertedOrientation(this.component,"statePosition","leading");var g=this.component.render("stateMargin",Echo.Sync.Button._defaultIconTextMargin);b=new Echo.Sync.TriCellTable(c,Echo.Sync.Extent.toPixels(e),f,Echo.Sync.Extent.toPixels(g));this.renderButtonText(b.tdElements[0],h);this.iconImg=this.renderButtonIcon(b.tdElements[1],d);this._stateElement=this._renderButtonState(b.tdElements[2]);this.div.appendChild(b.tableElement);}}}},renderDispose:function(a){Echo.Sync.Button.prototype.renderDispose.call(this,a);if(this._stateElement){Core.Web.Event.removeAll(this._stateElement);this._stateElement=null;}},_renderButtonState:function(a){var c=this.getStateIcon();var b;if(c){b=document.createElement("img");Echo.Sync.ImageReference.renderImg(c,b);}else{b=document.createElement("input");b.type=this.inputType;if(this.inputType=="radio"){b.name="__echo_"+Echo.Sync.RadioButton._nextNameId++;}b.defaultChecked=this._selected?true:false;Core.Web.Event.add(b,"change",Core.method(this,this._processStateChange),false);
Core.Web.Event.add(this.div,"click",Core.method(this,this._processStateChange),false);}a.appendChild(b);var d=this.component.render("stateAlignment");if(d){Echo.Sync.Alignment.render(d,a,true,this.component);}return b;},setHighlightState:function(b,c){Echo.Sync.Button.prototype.setHighlightState.call(this,b,c);var d=this.getStateIcon(b,c);if(d){var a=Echo.Sync.ImageReference.getUrl(d);if(this._stateElement.src!=a){this._stateElement.src=a;}}},setSelected:function(a){if(this._selected==a){return;}this._selected=a;this.component.set("selected",a);this._updateStateElement();},_updateStateElement:function(){var a=this.getStateIcon();if(a){this._stateElement.src=Echo.Sync.ImageReference.getUrl(a);}else{this._stateElement.checked=this._selected?true:false;}}});Echo.Sync.CheckBox=Core.extend(Echo.Sync.ToggleButton,{$load:function(){Echo.Render.registerPeer("CheckBox",this);},inputType:"checkbox"});Echo.Sync.RadioButton=Core.extend(Echo.Sync.ToggleButton,{$static:{_nextNameId:0,_groups:new Core.Arrays.LargeMap()},$load:function(){Echo.Render.registerPeer("RadioButton",this);
},inputType:"radio",_group:null,doAction:function(){if(this._group){this._group.deselect();}Echo.Sync.ToggleButton.prototype.doAction.call(this);},renderAdd:function(d,a){var b=this.component.render("group");if(b!=null){var c=Echo.Sync.RadioButton._groups.map[b];if(!c){c=new Echo.Sync.RadioButton.Group(b);Echo.Sync.RadioButton._groups.map[b]=c;}c.add(this);this._group=c;}Echo.Sync.ToggleButton.prototype.renderAdd.call(this,d,a);},renderDispose:function(a){Echo.Sync.ToggleButton.prototype.renderDispose.call(this,a);if(this._group){this._group.remove(this);if(this._group.size()===0){Echo.Sync.RadioButton._groups.remove(this._group.id);}this._group=null;}}});Echo.Sync.RadioButton.Group=Core.extend({id:null,_buttons:null,$construct:function(a){this.id=a;this._buttons=[];},add:function(a){this._buttons.push(a);},deselect:function(){for(var a=0;a<this._buttons.length;++a){this._buttons[a].setSelected(false);}},remove:function(b){var c=-1;for(var a=0;a<this._buttons.length;++a){if(this._buttons[a]==b){c=a;
break;}}if(c==-1){throw new Error("No such button: "+b.component.renderId);}if(this._buttons.length==1){this._buttons=[];}else{this._buttons[c]=this._buttons[this._buttons.length-1];this._buttons.length=this._buttons.length-1;}},size:function(){return this._buttons.length;}});
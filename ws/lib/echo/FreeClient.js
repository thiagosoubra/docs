Echo.FreeClient=Core.extend(Echo.Client,{_processUpdateRef:null,_doRenderRef:null,_resourcePaths:null,_renderPending:false,$construct:function(a,b){Echo.Client.call(this);this._doRenderRef=Core.method(this,this._doRender);this._processUpdateRef=Core.method(this,this._processUpdate);this.configure(a,b);this._processUpdate();},addResourcePath:function(a,b){if(!this._resourcePaths){this._resourcePaths={};}this._resourcePaths[a]=b;},dispose:function(){this.application.updateManager.removeUpdateListener(this._processUpdateRef);Echo.Render.renderComponentDispose(null,this.application.rootComponent);Echo.Client.prototype.dispose.call(this);},_doRender:function(){if(this.application){this.processUpdates();this._renderPending=false;}},getResourceUrl:function(a,b){if(this._resourcePaths&&this._resourcePaths[a]){return this._resourcePaths[a]+b;}else{return Echo.Client.prototype.getResourceUrl.call(this,a,b);}},init:function(){Core.Web.init();this.application.updateManager.addUpdateListener(this._processUpdateRef);
},loadStyleSheet:function(a){var b=new Core.Web.HttpConnection(a,"GET");b.addResponseListener(Core.method(this,this._processStyleSheet));b.connect();},_processStyleSheet:function(b){if(!b.valid){throw new Error("Received invalid response from StyleSheet HTTP request.");}var a=b.source.getResponseXml().documentElement;var c=Echo.Serial.loadStyleSheet(this,a);this.application.setStyleSheet(c);},_processUpdate:function(a){if(!this._renderPending){this._renderPending=true;Core.Web.Scheduler.run(this._doRenderRef);}}});
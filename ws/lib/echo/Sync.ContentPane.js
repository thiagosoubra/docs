Echo.Sync.ContentPane=Core.extend(Echo.Render.ComponentSync,{$load:function(){Echo.Render.registerPeer("ContentPane",this);},_floatingPaneStack:null,_zIndexRenderRequired:false,$construct:function(){this._floatingPaneStack=[];},getSize:function(){return new Core.Web.Measure.Bounds(this._div);},raise:function(a){if(this._floatingPaneStack[this._floatingPaneStack.length-1]==a){return;}Core.Arrays.remove(this._floatingPaneStack,a);this._floatingPaneStack.push(a);this._renderFloatingPaneZIndices();this._storeFloatingPaneZIndices();},renderAdd:function(g,a){var d;this._div=document.createElement("div");this._div.id=this.component.renderId;this._div.style.position="absolute";this._div.style.width="100%";this._div.style.height="100%";this._div.style.overflow="hidden";this._div.style.zIndex="0";Echo.Sync.renderComponentDefaults(this.component,this._div);var c=this.component.render("background");var e=this.component.render("backgroundImage");Echo.Sync.FillImage.render(e,this._div);if(!c&&!e){Echo.Sync.FillImage.render(this.client.getResourceUrl("Echo","resource/Transparent.gif"),this._div);
}this._childIdToElementMap={};var b=this.component.getComponentCount();for(d=0;d<b;++d){var f=this.component.getComponent(d);this._renderAddChild(g,f);}this._pendingScrollX=this.component.render("horizontalScroll");this._pendingScrollY=this.component.render("verticalScroll");a.appendChild(this._div);if(this._zIndexRenderRequired){this._renderFloatingPaneZIndices();}},_renderAddChild:function(c,a){var e=document.createElement("div");this._childIdToElementMap[a.renderId]=e;e.style.position="absolute";if(a.floatingPane){var h=a.render("zIndex");if(h!=null){var j=false;var d=0;while(d<this._floatingPaneStack.length&&!j){var f=this._floatingPaneStack[d].render("zIndex");if(f!=null&&f>h){this._floatingPaneStack.splice(d,0,a);j=true;}++d;}if(!j){this._floatingPaneStack.push(a);}}else{this._floatingPaneStack.push(a);}e.style.zIndex="1";e.style.left=e.style.top=0;this._zIndexRenderRequired=true;}else{var b=this.component.render("insets",0);var g=Echo.Sync.Insets.toPixels(b);e.style.zIndex="0";e.style.left=g.left+"px";
e.style.top=g.top+"px";e.style.bottom=g.bottom+"px";e.style.right=g.right+"px";if(a.pane){e.style.overflow="hidden";}else{switch(this.component.render("overflow")){case Echo.ContentPane.OVERFLOW_HIDDEN:e.style.overflow="hidden";break;case Echo.ContentPane.OVERFLOW_SCROLL:e.style.overflow="scroll";break;default:e.style.overflow="auto";break;}}}Echo.Render.renderComponentAdd(c,a,e);this._div.appendChild(e);},renderDisplay:function(){var h=this._div.firstChild;while(h){Core.Web.VirtualPosition.redraw(h);h=h.nextSibling;}if(this._pendingScrollX||this._pendingScrollY){var c=this.component.getComponentCount();for(var d=0;d<c;++d){h=this.component.getComponent(d);if(!h.floatingPane){var f=this._childIdToElementMap[h.renderId];var b,e;if(this._pendingScrollX){var a=Echo.Sync.Extent.toPixels(this._pendingScrollX);if(Echo.Sync.Extent.isPercent(this._pendingScrollX)||a<0){e=a<0?100:parseInt(this._pendingScrollX,10);b=Math.round((f.scrollWidth-f.offsetWidth)*e/100);if(b>0){f.scrollLeft=b;if(Core.Web.Env.ENGINE_MSHTML){b=Math.round((f.scrollWidth-f.offsetWidth)*e/100);
f.scrollLeft=b;}}}else{f.scrollLeft=a;}this._pendingScrollX=null;}if(this._pendingScrollY){var g=Echo.Sync.Extent.toPixels(this._pendingScrollY);if(Echo.Sync.Extent.isPercent(this._pendingScrollY)||g<0){e=g<0?100:parseInt(this._pendingScrollY,10);b=Math.round((f.scrollHeight-f.offsetHeight)*e/100);if(b>0){f.scrollTop=b;if(Core.Web.Env.ENGINE_MSHTML){b=Math.round((f.scrollHeight-f.offsetHeight)*e/100);f.scrollTop=b;}}}else{f.scrollTop=g;}this._pendingScrollY=null;}break;}}}},renderDispose:function(a){this._childIdToElementMap=null;this._div=null;},_renderFloatingPaneZIndices:function(){for(var b=0;b<this._floatingPaneStack.length;++b){var a=this._childIdToElementMap[this._floatingPaneStack[b].renderId];a.style.zIndex=2+b;}this._zIndexRenderRequired=false;},_renderRemoveChild:function(d,c){if(c.floatingPane){Core.Arrays.remove(this._floatingPaneStack,c);}var a=this._childIdToElementMap[c.renderId];if(!a){return;}var b=false;if(c.peer.renderContentPaneRemove){b=c.peer.renderContentPaneRemove(this._childIdToElementMap[c.renderId],Core.method(this,function(){a.parentNode.removeChild(a);
}));}if(!b){a.parentNode.removeChild(a);}delete this._childIdToElementMap[c.renderId];},renderUpdate:function(g){var c,d=false;if(g.hasUpdatedProperties()||g.hasUpdatedLayoutDataChildren()){d=true;}else{var a=g.getRemovedChildren();if(a){for(c=0;c<a.length;++c){this._renderRemoveChild(g,a[c]);}}var e=g.getAddedChildren();g.renderContext.displayRequired=[];if(e){for(c=0;c<e.length;++c){if(!e[c].floatingPane){g.renderContext.displayRequired=null;}this._renderAddChild(g,e[c],this.component.indexOf(e[c]));if(g.renderContext.displayRequired){g.renderContext.displayRequired.push(e[c]);}}if(this._zIndexRenderRequired){this._renderFloatingPaneZIndices();}}}if(d){this._floatingPaneStack=[];var b=this._div;var f=b.parentNode;Echo.Render.renderComponentDispose(g,g.parent);f.removeChild(b);this.renderAdd(g,f);}return d;},_storeFloatingPaneZIndices:function(){for(var a=0;a<this._floatingPaneStack.length;++a){this._floatingPaneStack[a].set("zIndex",a);}}});
Extras.Sync.Menu=Core.extend(Echo.Render.ComponentSync,{$static:{DEFAULTS:{foreground:"#000000",background:"#cfcfcf",disabledForeground:"#7f7f7f",selectionForeground:"#ffffff",selectionBackground:"#3f3f3f",border:"1px outset #cfcfcf"}},menuModel:null,stateModel:null,element:null,_openMenuPath:null,_maskDeployed:false,_processMaskClickRef:null,_overlay:null,$construct:function(){this._processMaskClickRef=Core.method(this,this._processMaskClick);this._openMenuPath=[];},$abstract:{getSubMenuPosition:function(a){},renderMain:function(a){}},$virtual:{activate:function(){if(this.component.get("active")){return false;}this.component.set("modal",true);this.component.set("active",true);this.addMask();this.client.application.setFocusedComponent(this.component);Core.Web.DOM.focusElement(this.element);return true;},activateItem:function(a){if(this.stateModel&&!this.stateModel.isEnabled(a.modelId)){return;}if(a instanceof Extras.OptionModel){this.deactivate();this.processAction(a);}else{if(a instanceof Extras.MenuModel){this._openMenu(a);
}}},processAction:function(a){this.component.doAction(a);}},addMenu:function(a){this._openMenuPath.push(a);},addMask:function(){if(this.maskDeployed){return;}this.maskDeployed=true;this._overlayAdd(new Core.Web.Measure.Bounds(this.element));Core.Web.Event.add(document.body,"click",this._processMaskClickRef,false);Core.Web.Event.add(document.body,"contextmenu",this._processMaskClickRef,false);},clientKeyDown:function(a){if(a.keyCode==27){this.deactivate();return false;}return true;},closeAll:function(){while(this._openMenuPath.length>0){var a=this._openMenuPath.pop();a.close();}},closeDescendants:function(a){while(a!=this._openMenuPath[this._openMenuPath.length-1]){var b=this._openMenuPath.pop();b.close();}},deactivate:function(){this.component.set("modal",false);if(!this.component.get("active")){return;}this.component.set("active",false);this.closeAll();this.removeMask();},isOpen:function(b){for(var a=0;a<this._openMenuPath.length;++a){if(this._openMenuPath[a].menuModel==b){return true;
}}return false;},_overlayAdd:function(e){this._overlayRemove();var b=e.top+e.height,d=e.left+e.width,a=new Core.Web.Measure.Bounds(document.body);this._overlay={};if(e.top>0){this._overlay.top=document.createElement("div");this._overlay.top.style.cssText="position:absolute;z-index:30000;top:0;left:0;width:100%;"+"height:"+e.top+"px;";document.body.appendChild(this._overlay.top);}if(b<a.height){this._overlay.bottom=document.createElement("div");this._overlay.bottom.style.cssText="position:absolute;z-index:30000;bottom:0;left:0;width:100%;"+"top:"+b+"px;";document.body.appendChild(this._overlay.bottom);}if(e.left>0){this._overlay.left=document.createElement("div");this._overlay.left.style.cssText="position:absolute;z-index:30000;left:0;"+"width:"+e.left+"px;top:"+e.top+"px;height:"+e.height+"px;";document.body.appendChild(this._overlay.left);}if(d<a.width){this._overlay.right=document.createElement("div");this._overlay.right.style.cssText="position:absolute;z-index:30000;right:0;"+"left:"+d+"px;top:"+e.top+"px;height:"+e.height+"px;";
document.body.appendChild(this._overlay.right);}for(var c in this._overlay){Echo.Sync.FillImage.render(this.client.getResourceUrl("Echo","resource/Transparent.gif"),this._overlay[c]);Core.Web.VirtualPosition.redraw(this._overlay[c]);}this.client.forceRedraw();},_overlayRemove:function(){if(!this._overlay){return;}for(var a in this._overlay){document.body.removeChild(this._overlay[a]);}this._overlay=null;this.client.forceRedraw();},_openMenu:function(f){if(this.isOpen(f)){return;}var b=new Extras.Sync.Menu.RenderedMenu(this,f);b.create();var c=null;for(var d=0;d<this._openMenuPath.length;++d){if(this._openMenuPath[d].menuModel==f.parent){c=this._openMenuPath[d];break;}}if(c==null){c=this;}else{this.closeDescendants(c);}var a=c.getSubMenuPosition(f);var e=new Core.Web.Measure.Bounds(document.body);if(a.x+b.width>e.width){a.x=e.width-b.width;if(a.x<0){a.x=0;}}if(a.y+b.height>e.height){a.y=e.height-b.height;if(a.y<0){a.y=0;}}b.open(a.x,a.y);this.addMenu(b);},_processMaskClick:function(a){this.deactivate();
return true;},removeMask:function(){if(!this.maskDeployed){return;}this._overlayRemove();this.maskDeployed=false;Core.Web.Event.remove(document.body,"click",this._processMaskClickRef,false);Core.Web.Event.remove(document.body,"contextmenu",this._processMaskClickRef,false);},renderAdd:function(b,a){this.menuModel=this.component.get("model");this.stateModel=this.component.get("stateModel");this.element=this.renderMain(b);this.element.tabIndex="-1";this.element.style.outlineStyle="none";a.appendChild(this.element);},renderDispose:function(a){this.deactivate();this.element=null;},renderFocus:function(){Core.Web.DOM.focusElement(this.element);},renderHide:function(){this.deactivate();},renderUpdate:function(c){if(c.isUpdatedPropertySetIn({active:true,modal:true})){return;}var a=this.element;var b=a.parentNode;Echo.Render.renderComponentDispose(c,c.parent);b.removeChild(a);this.renderAdd(c,b);return false;}});Extras.Sync.Menu.RenderedMenu=Core.extend({$static:{DEFAULTS:{iconTextMargin:5,menuInsets:"2px",menuItemInsets:"1px 12px"},FadeAnimation:Core.extend(Extras.Sync.Animation,{_element:null,$construct:function(b,a){this._element=b;
this.runTime=a;},init:function(){},step:function(a){this._element.style.opacity=a;},complete:function(a){this._element.style.opacity=1;}})},menuSync:null,component:null,client:null,element:null,itemElements:null,menuModel:null,width:null,height:null,_activeItem:null,stateModel:null,$construct:function(b,a){this.menuSync=b;this.menuModel=a;this.component=this.menuSync.component;this.client=this.menuSync.client;this.stateModel=this.menuSync.stateModel;this.itemElements={};},close:function(){Core.Web.Event.removeAll(this.element);document.body.removeChild(this.element);this.client.forceRedraw();this.element=null;this.itemElements=null;this._activeItem=null;},create:function(){var v,A,D,w,s,B;this.element=document.createElement("div");this.element.style.position="absolute";this.element.style.zIndex=30050;var c=(Core.Web.Env.NOT_SUPPORTED_CSS_OPACITY?100:this.component.render("menuOpacity",100))/100;var k=document.createElement("div");k.style.cssText="position:relative;z-index:10;";this.element.appendChild(k);
Echo.Sync.LayoutDirection.render(this.component.getLayoutDirection(),k);Echo.Sync.Insets.render(Extras.Sync.Menu.RenderedMenu.DEFAULTS.menuInsets,k,"padding");Echo.Sync.Border.render(this.component.render("menuBorder",Extras.Sync.Menu.DEFAULTS.border),k);var a;var f=this.component.render("menuForeground");if(f){a=f;}else{a=this.component.render("foreground",Extras.Sync.Menu.DEFAULTS.foreground);}Echo.Sync.Color.render(a,k,"color");var m=this.component.render("menuFont");if(!m){m=this.component.render("font");}if(m){Echo.Sync.Font.render(m,k);}var t;if(c<1){t=document.createElement("div");t.style.cssText="position:absolute;z-index:1;width:100%;height:100%;top:0;bottom:0;";t.style.opacity=c;this.element.appendChild(t);}else{t=this.element;}var x;var o=this.component.render("menuBackground");if(o){x=o;}else{x=this.component.render("background",Extras.Sync.Menu.DEFAULTS.background);}Echo.Sync.Color.render(x,t,"backgroundColor");var b;var r=this.component.render("menuBackgroundImage");if(r){b=r;
}else{if(o==null){b=this.component.render("backgroundImage");}}if(b){Echo.Sync.FillImage.render(b,t,null);}var d=document.createElement("table");d.style.borderCollapse="collapse";k.appendChild(d);var h=document.createElement("tbody");d.appendChild(h);var n=this.menuModel.items;var j=false;for(v=0;v<n.length;++v){A=n[v];if(A.icon||A instanceof Extras.ToggleOptionModel){j=true;break;}}var u,p;if(j){var y=Echo.Sync.Insets.toPixels(Extras.Sync.Menu.RenderedMenu.DEFAULTS.menuItemInsets);p="0px 0px 0px "+y.left+"px";u=y.top+"px "+y.right+"px "+y.bottom+"px "+y.left+"px";}else{u=Extras.Sync.Menu.RenderedMenu.DEFAULTS.menuItemInsets;}for(v=0;v<n.length;++v){A=n[v];if(A instanceof Extras.OptionModel||A instanceof Extras.MenuModel){B=document.createElement("tr");this.itemElements[A.id]=B;B.style.cursor="pointer";h.appendChild(B);if(j){s=document.createElement("td");Echo.Sync.Insets.render(p,s,"padding");if(A instanceof Extras.ToggleOptionModel){var l;var q=this.stateModel&&this.stateModel.isSelected(A.modelId);
if(A instanceof Extras.RadioOptionModel){l=q?"image/menu/RadioOn.gif":"image/menu/RadioOff.gif";}else{l=q?"image/menu/ToggleOn.gif":"image/menu/ToggleOff.gif";}D=document.createElement("img");D.src=this.client.getResourceUrl("Extras",l);s.appendChild(D);}else{if(A.icon){D=document.createElement("img");Echo.Sync.ImageReference.renderImg(A.icon,D);s.appendChild(D);}}B.appendChild(s);}w=document.createElement("td");Echo.Sync.Insets.render(u,w,"padding");w.style.whiteSpace="nowrap";if(this.stateModel&&!this.stateModel.isEnabled(A.modelId)){Echo.Sync.Color.render(this.component.render("disabledForeground",Extras.Sync.Menu.DEFAULTS.disabledForeground),w,"color");}w.appendChild(document.createTextNode(A.text));B.appendChild(w);if(A instanceof Extras.MenuModel){var g=document.createElement("td");g.style.textAlign="right";D=document.createElement("img");var z=this.component.render("menuExpandIcon",this.client.getResourceUrl("Extras","image/menu/ArrowRight.gif"));D.setAttribute("src",z.url?z.url:z);
D.setAttribute("alt","");g.appendChild(D);B.appendChild(g);}else{w.colSpan=2;}}else{if(A instanceof Extras.SeparatorModel){if(v===0||v===n.length-1||n[v-1] instanceof Extras.SeparatorModel||n[v+1] instanceof Extras.SeparatorModel){continue;}B=document.createElement("tr");h.appendChild(B);w=document.createElement("td");w.colSpan=j?3:2;w.style.padding="3px 0px";var C=document.createElement("div");C.style.cssText="border-top:1px solid #a7a7a7;height:0;font-size:1px;line-height:0";w.appendChild(C);B.appendChild(w);}}}var e=new Core.Web.Measure.Bounds(this.element);this.width=e.width;this.height=e.height;},_getItemElement:function(a){if(a==null){return null;}while(a.nodeName.toLowerCase()!="tr"){if(a==this.element){return null;}a=a.parentNode;}return a;},_getItemModel:function(c){var b=null;c=this._getItemElement(c);if(c==null){return null;}for(var a in this.itemElements){if(this.itemElements[a]==c){b=a;break;}}if(b==null){return null;}else{return this.menuModel.findItem(b);}},getSubMenuPosition:function(c){var d=this.itemElements[c.id];
var b=new Core.Web.Measure.Bounds(d);var a=new Core.Web.Measure.Bounds(this.element);return{x:a.left+a.width,y:b.top};},open:function(a,d){this.element.style.left=a+"px";this.element.style.top=d+"px";var c=this.component.render("animationTime",0);if(c&&!Core.Web.Env.NOT_SUPPORTED_CSS_OPACITY){this.element.style.opacity=0;var b=new Extras.Sync.Menu.RenderedMenu.FadeAnimation(this.element,c);b.start();}document.body.appendChild(this.element);this.client.forceRedraw();Core.Web.Event.add(this.element,"click",Core.method(this,this._processClick),false);Core.Web.Event.add(this.element,"mouseover",Core.method(this,this._processItemEnter),false);Core.Web.Event.add(this.element,"mouseout",Core.method(this,this._processItemExit),false);Core.Web.Event.Selection.disable(this.element);},_processClick:function(b){Core.Web.DOM.preventEventDefault(b);var a=this._getItemModel(Core.Web.DOM.getEventTarget(b));if(a){this._setActiveItem(a,true);}},_processItemEnter:function(a){this._processRollover(a,true);
},_processItemExit:function(a){this._processRollover(a,false);},_processRollover:function(d,c){if(!this.client||!this.client.verifyInput(this.component)||Core.Web.dragInProgress){return true;}var a=this._getItemElement(Core.Web.DOM.getEventTarget(d));if(!a){return;}var b=this._getItemModel(a);if(!b){return;}if(this.stateModel&&!this.stateModel.isEnabled(b.modelId)){return;}if(c){this._setActiveItem(b,false);}},_setActiveItem:function(a,b){if(this._activeItem){this._setItemHighlight(this._activeItem,false);this._activeItem=null;}if(a instanceof Extras.MenuModel){this.menuSync.activateItem(a);}else{if(b){this.menuSync.activateItem(a);return;}else{this.menuSync.closeDescendants(this);}}if(a){this._activeItem=a;this._setItemHighlight(this._activeItem,true);}},_setItemHighlight:function(b,c){var a=this.itemElements[b.id];if(c){Echo.Sync.FillImage.render(this.component.render("selectionBackgroundImage"),a);Echo.Sync.Color.render(this.component.render("selectionBackground",Extras.Sync.Menu.DEFAULTS.selectionBackground),a,"backgroundColor");
Echo.Sync.Color.render(this.component.render("selectionForeground",Extras.Sync.Menu.DEFAULTS.selectionForeground),a,"color");}else{a.style.backgroundImage="";a.style.backgroundColor="";a.style.color="";}}});Extras.Sync.ContextMenu=Core.extend(Extras.Sync.Menu,{$load:function(){Echo.Render.registerPeer("Extras.ContextMenu",this);},_mouseX:null,_mouseY:null,getSubMenuPosition:function(a){return{x:this._mouseX,y:this._mouseY};},_processContextClick:function(a){if(!this.client||!this.client.verifyInput(this.component)||Core.Web.dragInProgress){return true;}Core.Web.DOM.preventEventDefault(a);this._mouseX=a.pageX||(a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft));this._mouseY=a.pageY||(a.clientY+(document.documentElement.scrollTop||document.body.scrollTop));this.activate();this.activateItem(this.menuModel);},renderDispose:function(a){Core.Web.Event.removeAll(this.element);Extras.Sync.Menu.prototype.renderDispose.call(this,a);},renderMain:function(d){var c=document.createElement("div");
c.id=this.component.renderId;var a=this.component.render("activationMode",Extras.ContextMenu.ACTIVATION_MODE_CONTEXT_CLICK);if(a&Extras.ContextMenu.ACTIVATION_MODE_CLICK){Core.Web.Event.add(c,"click",Core.method(this,this._processContextClick),false);}if(a&Extras.ContextMenu.ACTIVATION_MODE_CONTEXT_CLICK){Core.Web.Event.add(c,"contextmenu",Core.method(this,this._processContextClick),false);}var b=this.component.getComponentCount();if(b>0){Echo.Render.renderComponentAdd(d,this.component.getComponent(0),c);}return c;},renderUpdate:function(f){if(f.isUpdatedPropertySetIn({active:true,modal:true,stateModel:true,model:true})){var b=f.getRemovedChildren();if(b){Core.Web.DOM.removeNode(this.element.firstChild);}var e=f.getAddedChildren();if(e){Echo.Render.renderComponentAdd(f,e[0],this.element);}var a=f.getUpdatedProperty("model");var c=f.getUpdatedProperty("stateModel");var d=this.maskDeployed&&(a||c);if(d){this.deactivate();}if(a){this.menuModel=a.newValue;}if(c){this.stateModel=c.newValue;}if(d){this.activate();
this.activateItem(this.menuModel);}return false;}Extras.Sync.Menu.prototype.renderUpdate.call(this,f);return true;}});Extras.Sync.DropDownMenu=Core.extend(Extras.Sync.Menu,{$load:function(){Echo.Render.registerPeer("Extras.DropDownMenu",this);},_contentDiv:null,_selectedItem:null,_createSelectionContent:function(c){var a;if(c.icon){if(c.text){var d=document.createElement("table");d.style.cssText="border-collapse:collapse;padding:0;";var b=document.createElement("tbody");var e=document.createElement("tr");var g=document.createElement("td");g.style.cssText="padding:0vertical-align:top;";a=document.createElement("img");Echo.Sync.ImageReference.renderImg(c.icon,a);g.appendChild(a);e.appendChild(g);g=document.createElement("td");g.style.cssText="padding:width:3px;";var f=document.createElement("div");f.style.cssText="width:3px";g.appendChild(f);e.appendChild(g);g=document.createElement("td");g.style.cssText="padding:0vertical-align:top;";g.appendChild(document.createTextNode(c.text));e.appendChild(g);
b.appendChild(e);d.appendChild(b);return d;}else{a=document.createElement("img");Echo.Sync.ImageReference.renderImg(c.icon,a);return a;}}else{return document.createTextNode(c.text?c.text:"\u00a0");}},getSubMenuPosition:function(a){var b=new Core.Web.Measure.Bounds(this.element);return{x:b.left,y:b.top+b.height};},processAction:function(a){if(this.component.render("selectionEnabled")){this._setSelection(a);}var b=a.getItemPositionPath().join(".");this.component.set("selection",b);Extras.Sync.Menu.prototype.processAction.call(this,a);},_processClick:function(a){if(!this.client||!this.client.verifyInput(this.component)||Core.Web.dragInProgress){return true;}Core.Web.DOM.preventEventDefault(a);this.activate();this.activateItem(this.menuModel);},renderDispose:function(a){Core.Web.Event.removeAll(this.element);this._contentDiv=null;Extras.Sync.Menu.prototype.renderDispose.call(this,a);},renderMain:function(){var e=document.createElement("div");e.id=this.component.renderId;e.style.cssText="overflow:hidden;cursor:pointer;";
Echo.Sync.LayoutDirection.render(this.component.getLayoutDirection(),e);Echo.Sync.Color.render(this.component.render("foreground",Extras.Sync.Menu.DEFAULTS.foreground),e,"color");Echo.Sync.Color.render(this.component.render("background",Extras.Sync.Menu.DEFAULTS.background),e,"backgroundColor");Echo.Sync.FillImage.render(this.component.render("backgroundImage"),e);Echo.Sync.Border.render(this.component.render("border",Extras.Sync.Menu.DEFAULTS.border),e);Echo.Sync.Extent.render(this.component.render("width"),e,"width",true,true);Echo.Sync.Extent.render(this.component.render("height"),e,"height",false,true);var f=document.createElement("div");f.style.cssText="float:right;position:relative;";e.appendChild(f);var c=document.createElement("div");c.style.cssText="position:absolute;top:2px;right:2px;";var b=this.component.render("expandIcon",this.client.getResourceUrl("Extras","image/menu/ArrowDown.gif"));var d=document.createElement("img");Echo.Sync.ImageReference.renderImg(b,d);c.appendChild(d);
f.appendChild(c);this._contentDiv=document.createElement("div");this._contentDiv.style.cssText="float:left;";if(!this.component.render("lineWrap")){this._contentDiv.style.whiteSpace="nowrap";}Echo.Sync.Insets.render(this.component.render("insets","2px 5px"),this._contentDiv,"padding");e.appendChild(this._contentDiv);var g=document.createElement("div");g.style.cssText="clear:both;";e.appendChild(g);Core.Web.Event.add(e,"click",Core.method(this,this._processClick),false);Core.Web.Event.Selection.disable(e);if(this.component.render("selectionEnabled")){var h=this.component.render("selection");if(h){this._selectedItem=this.menuModel.getItemModelFromPositions(h.split("."));}}else{this._selectedItem=null;}if(this._selectedItem){this._contentDiv.appendChild(this._createSelectionContent(this._selectedItem));}else{var a=this.component.render("selectionText");this._contentDiv.appendChild(document.createTextNode(a?a:"\u00a0"));}if(!this.component.render("height")){var i=new Core.Web.Measure.Bounds(this._contentDiv);
f.style.height=i.height+"px";}return e;},_setSelection:function(b){this._selectedItem=b;for(var a=this._contentDiv.childNodes.length-1;a>=0;--a){this._contentDiv.removeChild(this._contentDiv.childNodes[a]);}this._contentDiv.appendChild(this._createSelectionContent(b));}});Extras.Sync.MenuBarPane=Core.extend(Extras.Sync.Menu,{$static:{DEFAULTS:{itemInsets:"0px 12px",insets:"3px 0px"}},$load:function(){Echo.Render.registerPeer("Extras.MenuBarPane",this);},_activeItem:null,_menuBarTable:null,_menuBarBorderHeight:null,itemElements:null,$construct:function(){Extras.Sync.Menu.call(this);this.itemElements={};},activate:function(){if(Extras.Sync.Menu.prototype.activate.call(this)){this.addMenu(this);}},close:function(){if(this._activeItem){this._setItemHighlight(this._activeItem,false);this._activeItem=null;}},_getItemElement:function(a){if(a==null){return null;}while(a.nodeName.toLowerCase()!="td"){if(a==this.element){return null;}a=a.parentNode;}return a;},_getItemModel:function(c){var b=null;
c=this._getItemElement(c);if(c==null){return null;}for(var a in this.itemElements){if(this.itemElements[a]==c){b=a;break;}}if(b==null){return null;}else{return this.menuModel.findItem(b);}},getPreferredSize:function(){this._menuBarTable.style.height="";var a=Echo.Sync.Insets.toPixels(this.component.render("insets",Extras.Sync.MenuBarPane.DEFAULTS.insets));return{height:new Core.Web.Measure.Bounds(this.element).height+a.top+a.bottom};},getSubMenuPosition:function(d){var b=this.itemElements[d.id];if(!b){throw new Error("Invalid menu: "+d);}var a=new Core.Web.Measure.Bounds(this.element);var c=new Core.Web.Measure.Bounds(b);return{x:c.left,y:a.top+a.height};},_processClick:function(b){if(!this.client||!this.client.verifyInput(this.component)){return true;}Core.Web.DOM.preventEventDefault(b);var a=this._getItemModel(Core.Web.DOM.getEventTarget(b));if(a){if(a instanceof Extras.OptionModel){this.deactivate();this.processAction(a);}else{this.activate();this._setActiveItem(a,true);}}else{this.deactivate();
}},_processItemEnter:function(a){this._processRollover(a,true);},_processItemExit:function(a){this._processRollover(a,false);},_processRollover:function(d,c){if(!this.client||!this.client.verifyInput(this.component)||Core.Web.dragInProgress){return true;}var a=this._getItemElement(Core.Web.DOM.getEventTarget(d));if(!a){return;}var b=this._getItemModel(a);if(this.stateModel&&!this.stateModel.isEnabled(b.modelId)){return;}if(this.component.get("active")){if(c){this._setActiveItem(b,b instanceof Extras.MenuModel);}}else{this._setItemHighlight(b,c);}},renderDisplay:function(){Core.Web.VirtualPosition.redraw(this.element);var b=new Core.Web.Measure.Bounds(this.element.parentNode);var a=b.height-this._menuBarBorderHeight;this._menuBarTable.style.height=a<=0?"":a+"px";},renderDispose:function(a){this._menuBarTable=null;Core.Web.Event.removeAll(this.element);Extras.Sync.Menu.prototype.renderDispose.call(this,a);},renderMain:function(d){var b=document.createElement("div");b.id=this.component.renderId;
b.style.cssText="overflow:hidden;";Echo.Sync.renderComponentDefaults(this.component,b);var c=this.component.render("border",Extras.Sync.Menu.DEFAULTS.border);var k=Echo.Sync.Border.isMultisided(c);this._menuBarBorderHeight=Echo.Sync.Border.getPixelSize(c,"top")+Echo.Sync.Border.getPixelSize(c,"bottom");Echo.Sync.Border.render(k?c.top:c,b,"borderTop");Echo.Sync.Border.render(k?c.bottom:c,b,"borderBottom");Echo.Sync.FillImage.render(this.component.render("backgroundImage"),b);this._menuBarTable=document.createElement("table");this._menuBarTable.style.borderCollapse="collapse";b.appendChild(this._menuBarTable);var g=document.createElement("tbody");this._menuBarTable.appendChild(g);var a=document.createElement("tr");g.appendChild(a);if(this.menuModel==null||this.menuModel.items.length===0){a.appendChild(this._createMenuBarItem("\u00a0",null));}else{var f=this.menuModel.items;for(var e=0;e<f.length;++e){var j=f[e];if(j instanceof Extras.OptionModel||j instanceof Extras.MenuModel){var h=this._createMenuBarItem(j.text,j.icon);
a.appendChild(h);this.itemElements[j.id]=h;}}Core.Web.Event.add(b,"click",Core.method(this,this._processClick),false);Core.Web.Event.add(b,"mouseover",Core.method(this,this._processItemEnter),false);Core.Web.Event.add(b,"mouseout",Core.method(this,this._processItemExit),false);}Core.Web.Event.Selection.disable(b);return b;},_createMenuBarItem:function(d,b){var f=document.createElement("td");f.style.padding="0px";f.style.cursor="pointer";var e=document.createElement("div");e.style.whiteSpace="nowrap";Echo.Sync.Insets.render(Extras.Sync.MenuBarPane.DEFAULTS.itemInsets,e,"padding");f.appendChild(e);if(b){var a=document.createElement("img");a.style.verticalAlign="middle";a.src=b;e.appendChild(a);if(d){a.style.paddingRight="1ex";}}if(d){var c=document.createElement("span");c.style.verticalAlign="middle";c.appendChild(document.createTextNode(d));e.appendChild(c);}return f;},_setActiveItem:function(a,b){if(this._activeItem==a){return;}if(this._activeItem){this._setItemHighlight(this._activeItem,false);
this._activeItem=null;}if(b){this.activateItem(a);}if(a){this._activeItem=a;this._setItemHighlight(this._activeItem,true);}},_setItemHighlight:function(b,c){var a=this.itemElements[b.id];if(c){Echo.Sync.FillImage.render(this.component.render("selectionBackgroundImage"),a);Echo.Sync.Color.render(this.component.render("selectionBackground",Extras.Sync.Menu.DEFAULTS.selectionBackground),a,"backgroundColor");Echo.Sync.Color.render(this.component.render("selectionForeground",Extras.Sync.Menu.DEFAULTS.selectionForeground),a,"color");}else{a.style.backgroundImage="";a.style.backgroundColor="";a.style.color="";}}});
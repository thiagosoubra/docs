Extras.MenuComponent=Core.extend(Echo.Component,{$abstract:true,modalSupport:true,focusable:true,doAction:function(a){var b=a.getItemPositionPath().join(".");if(a instanceof Extras.ToggleOptionModel){this._toggleItem(a);}this.fireEvent({type:"action",source:this,data:b,modelId:a.modelId});},_toggleItem:function(c){var a=this.get("model");var e=this.get("stateModel");if(c.groupId){var d=a.findItemGroup(c.groupId);for(var b=0;b<d.length;++b){e.setSelected(d[b].modelId,false);}}if(e){e.setSelected(c.modelId,!e.isSelected(c.modelId));}}});Extras.ContextMenu=Core.extend(Extras.MenuComponent,{$static:{ACTIVATION_MODE_CLICK:1,ACTIVATION_MODE_CONTEXT_CLICK:2},$load:function(){Echo.ComponentFactory.registerType("Extras.ContextMenu",this);},componentType:"Extras.ContextMenu"});Extras.DropDownMenu=Core.extend(Extras.MenuComponent,{$load:function(){Echo.ComponentFactory.registerType("Extras.DropDownMenu",this);},componentType:"Extras.DropDownMenu"});Extras.MenuBarPane=Core.extend(Extras.MenuComponent,{$load:function(){Echo.ComponentFactory.registerType("Extras.MenuBarPane",this);
},componentType:"Extras.MenuBarPane"});Extras.ItemModel=Core.extend({$abstract:true,modelId:null,parent:null});Extras.MenuModel=Core.extend(Extras.ItemModel,{text:null,icon:null,items:null,$construct:function(e,d,c,a){this.modelId=e;this.id=Extras.uniqueId++;this.parent=null;this.text=d;this.icon=c;if(a){for(var b=0;b<a.length;++b){a[b].parent=this;}}this.items=a?a:[];},addItem:function(a){this.items.push(a);a.parent=this;},findItem:function(c){var a;for(a=0;a<this.items.length;++a){if(this.items[a].id==c){return this.items[a];}}for(a=0;a<this.items.length;++a){if(this.items[a] instanceof Extras.MenuModel){var b=this.items[a].findItem(c);if(b){return b;}}}return null;},findItemGroup:function(c){var d=[];for(var b=0;b<this.items.length;++b){if(this.items[b] instanceof Extras.MenuModel){var e=this.items[b].findItemGroup(c);for(var a=0;a<e.length;++a){d.push(e[a]);}}else{if(this.items[b].groupId==c){d.push(this.items[b]);}}}return d;},getItemModelFromPositions:function(b){var c=this;for(var a=0;
a<b.length;++a){c=c.items[parseInt(b[a],10)];}return c;},indexOfItem:function(b){for(var a=0;a<this.items.length;++a){if(this.items[a]==b){return a;}}return -1;},toString:function(){return'MenuModel "'+this.text+'" Items:'+this.items.length;}});Extras.OptionModel=Core.extend(Extras.ItemModel,{text:null,icon:null,$construct:function(c,b,a){this.modelId=c;this.id=Extras.uniqueId++;this.parent=null;this.text=b;this.icon=a;},getItemPositionPath:function(){var b=[];var a=this;while(a.parent!=null){b.unshift(a.parent.indexOfItem(a));a=a.parent;}return b;},toString:function(){return'OptionModel "'+this.text+'"';}});Extras.ToggleOptionModel=Core.extend(Extras.OptionModel,{$construct:function(b,a){Extras.OptionModel.call(this,b,a,null);}});Extras.RadioOptionModel=Core.extend(Extras.ToggleOptionModel,{groupId:null,$construct:function(c,b,a){Extras.ToggleOptionModel.call(this,c,b);this.groupId=a;}});Extras.SeparatorModel=Core.extend(Extras.ItemModel,{});Extras.MenuStateModel=Core.extend({_disabledItems:null,_selectedItems:null,$construct:function(){this._disabledItems=[];
this._selectedItems=[];},$virtual:{isEnabled:function(b){if(b){for(var a=0;a<this._disabledItems.length;a++){if(this._disabledItems[a]==b){return false;}}}return true;},isSelected:function(b){if(b){for(var a=0;a<this._selectedItems.length;a++){if(this._selectedItems[a]==b){return true;}}}return false;},setEnabled:function(b,a){if(a){Core.Arrays.remove(this._disabledItems,b);}else{if(Core.Arrays.indexOf(this._disabledItems,b)==-1){this._disabledItems.push(b);}}},setSelected:function(b,a){if(a){if(Core.Arrays.indexOf(this._selectedItems,b)==-1){this._selectedItems.push(b);}}else{Core.Arrays.remove(this._selectedItems,b);}}}});